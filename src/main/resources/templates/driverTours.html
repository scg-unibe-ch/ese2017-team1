<!DOCTYPE HTML>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>showJobs</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous" />
</head>
<body style="background-color: #87AFC7">
<h1>
    <div class="text-right">
        <!-- Logout Button -->
        <a href="/logout">
            <button type="button" class="btn btn-outline-warning btn-lg">
                Logout
            </button>
        </a>
        <a href="/info/user">
            <button type="button" class="btn btn-outline-warning btn-lg">
                Userinfo
            </button>
        </a>
    </div>
    Touren
</h1>
<br/>
<table style="width:100%">
    <thead>
    <tr>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'AuftragsId'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Produkt'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Menge'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Kunde'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Adresse'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Stadt'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Land'"/></b></td>
        <td><b><li class="list-group-item list-group-item-warning" th:text="'Status'"/></b></td>
    </tr>
    </thead>
    <tbody>
    <tr th:each="match : ${matches}" id="test">
        <td><li class="list-group-item list-group-item-warning" th:text="${match.id}"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.product.productName}"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.amount}"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.client.name}"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.client.street}" id="address"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.client.city}" id="city"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.client.land}" id="land"/></td>
        <td><li class="list-group-item list-group-item-warning" th:text="${match.accOrRej}"/></td>
        <td>
            <a th:href="${'/driverTours/'+match.id+'/akzeptiert'}">
                <button type="button" class="btn btn-outline-warning btn-lg">
                    Akzeptiert
                </button>
            </a>
            <a th:href="${'/driverTours/'+match.id+'/abgelehnt'}">
                <button type="button" class="btn btn-outline-warning btn-lg">
                    Abgelehnt
                </button>
            </a>
        </td>
    </tr>
    </tbody>
</table>
<br/>
<input type="button" class="btn btn-outline-warning btn-lg" value="ZurÃ¼ck" onclick="javascript:history.back()"/>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

<style>
    #map {
        height: 400px;
        width: 50%;
    }
</style>

<script th:inline="javascript" >
    /*<![CDATA[*/
    function initMap() {
        var marker1;
        var marker2;
        // Here the map is initialized
        var bernExwi = {lat: 46.951129, lng: 7.438773};
        var directionDisplay;
        var directionsService = new google.maps.DirectionsService();
        directionsDisplay = new google.maps.DirectionsRenderer();
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 4,
            center: bernExwi
        });
        // Here the point is set
        marker1 = new google.maps.Marker({
            position: bernExwi,
            map: map
        });
        var addresses = [[${addresses}]];
        var geocoder = new google.maps.Geocoder();
        for (var i = 0; i < addresses.length; i++) {
            codeAddress(addresses[i]);
        }

        directionsDisplay.setMap(map);
        calcRoute();


        function codeAddress(address) {
            geocoder.geocode({address: address}, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    map.setCenter(results[0].geometry.location);//center the map over the result
                    //place a marker at the location
                    var marker = new google.maps.Marker(
                        {
                            map: map,
                            position: results[0].geometry.location
                        });
                    return results[0].geometry.location
                } else {
                    alert('Geocode was not successful for the following reason: ' + status);
                }
            });
        }
        function calcRoute() {
            var waypts = [];


            for (var i = 0; i < addresses.length-1; i++) {
                var addr = addresses[i];
                if (addr !== "") {
                    waypts.push({
                        location: addr,
                        stopover: true
                    });
                }
            }
            start = bernExwi;
            end =  addresses[addresses.length-1];
            var request = {
                origin: start,
                destination: end,
                waypoints: waypts,
                optimizeWaypoints: true,
                travelMode: google.maps.DirectionsTravelMode.DRIVING
            };
            directionsService.route(request, function (response, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(response);
                    var route = response.routes[0];
                }
            });
        }

    }
    /*]]>*/
</script>

<script async="async" defer="defer" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvRi8WcVAqTsx-TC7Xi_spt2wCNTuolyc&amp;callback=initMap"></script>

</body>


</html>